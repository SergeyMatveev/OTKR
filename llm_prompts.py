SYSTEM_PROMPT_STAGE2 = """
Вход: один кредитный блок в Markdown.

Ответ: РОВНО 4 строки без кода, таблиц и любой Markdown-разметки, без «#», «##» и т.п.

Текст не изменяй, кроме склейки переносов слов/строк. Данные бери только из блока, ничего не придумывай.

Если значение поля не найдено — ставь ровно «Н/Д» (кириллица, заглавные Н и Д, слэш /). Любые OCR-варианты («H/Д», «Н/д», «н/д» и т.п.) приводи к «Н/Д».

УИд договора:
— Ищи метки «УИд договора», «УИД договора», «Уид договора».
— Кандидат нормализуй: убери пробелы и переводы строк, все тире замени на «-», латиницу сделай строчной.
— Допустимые OCR-подстановки: O↔0, I↔1, l↔1, S↔5, Z↔2, B↔8.
— В первых 5 группах разрешены только [0-9a-f], кириллица запрещена.
— Формат обязателен: 8-4-4-4-12-1 (пример: c456294b-dcd0-11aa-81b3-efa2ccd7b24f-7).
— Можно восстановить только пропущенные дефисы по схеме 8-4-4-4-12-1, символы не придумывай.
— Если валидного идентификатора нет — пиши «Не найдено».

Поля:

Прекращение обязательства — только «Н/Д» или «Надлежащее исполнение обязательства».

Дата сделки — как в тексте.

Сумма и валюта — сумма как в тексте, в ответе валюта обязательно «RUB».

УИд договора — см. правила выше.

Формат ответа — строго 4 строки, в этом порядке, без лишних строк и комментариев:

Прекращение обязательства: …
Дата сделки: …
Сумма и валюта: …
УИд договора: … 
""".strip()

PROMPT_STAGE5 = """
Ты получаешь ОДИН кредитный блок в формате Markdown (MD).
ТВОЯ ЗАДАЧА — вернуть РОВНО 2 СТРОКИ С ЖЁСТКИМИ ПРЕФИКСАМИ (без кода, без таблиц, без Markdown-разметки):

Приобретатель прав кредитора: ...
ИНН приобретателя прав кредитора: ...

Требования:
- Если поле отсутствует — пиши строго: Н/Д (кириллица, заглавные Н и Д, слэш /).
- В ИНН — РОВНО 10 ЦИФР (иначе Н/Д).
- НИКАКИХ дополнительных строк, пустых строк, комментариев, описаний, JSON и т.п.
- Если вернёшь без префиксов — ответ считается НЕВАЛИДНЫМ. Всегда пиши указанные префиксы в начале строк.
""".strip()

SYSTEM_PROMPT_INN_FALLBACK = """
Ты получаешь ОДИН кредитный блок целиком (Markdown-текст отчёта НБКИ).

НАЙДИ в нём ИНН организации — последовательность РОВНО из 10 цифр.

Требования к ответу:
- Ответь строго ОДНОЙ строкой.
- Если ИНН найден — верни ТОЛЬКО эти 10 цифр подряд, без пробелов, без комментариев, без дополнительных слов.
- Если ИНН нет или его нельзя однозначно определить по тексту — верни ровно: Н/Д (кириллица, заглавные Н и Д, слэш /).

Никаких JSON, описаний, пояснений, перевода строки или других символов, только одна строка по правилам выше.
""".strip()

SYSTEM_PROMPT_STAGE4_FALLBACK = """
Ты получаешь фрагмент таблицы из отчёта НБКИ в текстовом виде (строки с датами и числовыми значениями).

Твоя задача — найти сумму срочной задолженности.

Правила:

1. Найди строку с САМОЙ ПОЗДНЕЙ датой.
   Формат даты: dd.mm.yyyy или dd-mm-yyyy.
2. В этой строке сумма срочной задолженности находится в ТРЕТЬЕМ столбце слева:
   - 1-й столбец — дата.
   - 2-й столбец — какое-то значение (может быть числом или «Н/Д») — его нужно игнорировать.
   - 3-й столбец — искомая сумма срочной задолженности.
3. Сумма может быть:
   - целым числом (например, 32934),
   - числом с пробелами как разделителями тысяч (например, 32 934),
   - числом с запятой для копеек (например, 32934,00 или 12 345,67).
   Считай пробелы внутри числа частью записи числа.
4. НИЧЕГО не придумывай. Используй только те данные, которые есть в тексте.
   Если по тексту невозможно однозначно определить сумму срочной задолженности, нужно вернуть «Срочная задолженность: Н/Д».

Пример:
Строка:
|  14-12-2021 | Н/Д | 32934 | Н/Д | Н/Д | Н/Д | Нет  |
В этом случае:
- самая поздняя дата — 14-12-2021;
- 3-й столбец — 32934;
- правильный ответ: Срочная задолженность: 32934

Формат ответа:

- Ответь СТРОГО ОДНОЙ строкой вида:
  Срочная задолженность: <значение>

Где <значение> — найденная сумма ровно в том виде, как она указана в тексте (без добавления валюты), либо Н/Д.
Никакого дополнительного текста, комментариев, объяснений, JSON, кавычек или лишних строк.
""".strip()
